
* Kitchen

#+begin_src emacs-lisp

  ;; (defun meliache-file-is-root-p (name)
  ;;   "Check whether tramp su/sudo method is used for opening filepath NAME."
  ;;   ;; Adopted from https://www.gnu.org/software/emacs/manual/html_node/tramp/Auto_002dsave-File-Lock-and-Backup.html
  ;;   (let ((method (file-remote-p name 'method)))
  ;;     (when (stringp method)
  ;; 	(member method '("su" "sudo")))))
  ;; (defun meliache-file-is-not-root-p (name)
  ;;   (not (meliache-file-is-root-p name)))
  ;; (defun my-backup-enable-predicate (name)
  ;;   (and (normal-backup-enable-predicate name)
  ;; 	 ;; don't save password files
  ;; 	 (not (s-starts-with? "/dev/shm" name))
  ;; 	 (not (s-contains? "password-store" name))
  ;; 	 (meliache-file-is-not-root-p name)))
  ;; (setq backup-enable-predicate #'my-backup-enable-predicate)



  ;; ;; disable auto-save on certain tramp profiles
  ;; (connection-local-set-profile-variables
  ;;  'no-remote-auto-save-profile
  ;;  '((buffer-auto-save-file-name . nil)
  ;;    (remote-file-name-inhibit-auto-save-visited . t)
  ;;    (remote-file-name-inhibit-auto-save . t)))

  ;; ;; disable auto-save for specific protocols
  ;; (dolist (protocol '("sudo" "doas" "su" "sudoedit" "ssh"))
  ;;   (connection-local-set-profiles
  ;;    `(:application tramp :protocol ,protocol 'no-remote-auto-sav

#+end_src
